# Reusable Components & Libraries Documentation

This document provides a comprehensive inventory of all reusable components, utilities, and external libraries used in the Nasty Nomenclature project.

## Table of Contents

1. [JavaScript Components](#javascript-components)
2. [HTML Components](#html-components)
3. [External Libraries](#external-libraries)
4. [Utility Functions](#utility-functions)
5. [Component Patterns](#component-patterns)

---

## JavaScript Components

### Location: `js/common.js`

All reusable JavaScript components are centralized in a single file for easy maintenance and sharing across pages.

#### 1. Modal System

##### Source Modal Component

**Purpose:** Display a confirmation dialog before redirecting to GitHub source code.

**API:**
```javascript
// Open the modal
openSourceModal()

// Close the modal
closeSourceModal()

// Handle redirect confirmation
confirmSourceRedirect()

// Handle ESC key press
handleSourceModalKeydown(event)
```

**HTML ID:** `sourceModal`

**Features:**
- Scale-in animation on open
- Keyboard support (ESC to close)
- Focus trap and management
- Backdrop blur effect
- Previous focus restoration

**Generated By:**
```javascript
getSourceModalHTML()
```

**Markup Location:** Injected into `document.body` by `renderSharedLayout()`

---

#### 2. Disclaimer Modal Component

**Purpose:** Display content warning about adult material on first page load.

**API:**
```javascript
// Accept the disclaimer
acceptDisclaimer()

// Reject and redirect away
rejectDisclaimer()
```

**HTML ID:** `disclaimerModal`

**Features:**
- Persisted acceptance via localStorage/cookies
- Shows only once per user
- Styled with gradient background
- Dual-button interface (Accept/Reject)

**Persistence:**
- Stored key: `disclaimerAccepted` with value `'true'`
- Falls back to cookies if localStorage unavailable
- 365-day expiration on cookie

**Markup Location:** Hard-coded into each HTML page's `<body>`

---

#### 3. Layout Injection System

**Purpose:** Inject shared header, footer, and modals on page load.

**API:**
```javascript
// Main initialization function (called on DOMContentLoaded)
renderSharedLayout()
```

**Injected Elements:**
- Header (into `#site-header`)
- Footer (into `#site-footer`)
- Source modal (appended to body if not present)

**Dependencies:**
- `getHeaderHTML(currentPage)`
- `getFooterHTML()`
- `getSourceModalHTML()`
- `inferCurrentPage()`

**Trigger:** `DOMContentLoaded` event

---

#### 4. Navigation System

**Purpose:** Manage navigation links with active state detection.

**Data Structure:**
```javascript
const NAV_ITEMS = [
  { key: 'intro', href: 'index.html', label: 'The Intro' },
  { key: 'styles', href: 'styles.html', label: 'The Styles' },
  { key: 'forbidden', href: 'forbidden.html', label: 'The Forbidden' },
  { key: 'exchanges', href: 'exchanges.html', label: 'Exchanges' },
  { key: 'toy', href: 'toy.html', label: 'The Toy' }
];
```

**Functions:**
```javascript
// Build navigation HTML with active state indicators
buildNavLinks(currentPage)

// Detect current page from URL or data attribute
inferCurrentPage()
```

**Active State Detection:**
1. Reads `document.body.dataset.page` attribute
2. Fallback: Parses `window.location.pathname`
3. Applies `text-fuchsia-400` class to current page link
4. Adds `aria-current="page"` ARIA attribute

**To Add a New Navigation Item:**
1. Add to `NAV_ITEMS` array
2. Create new HTML file with `data-page="key"`
3. Update `inferCurrentPage()` if needed

---

#### 5. Page Transition System

**Purpose:** Smooth page transitions with fade animations.

**API:**
```javascript
// Set up page transition interceptors
setupPageTransitions()
```

**Features:**
- Intercepts all internal `<a>` links
- Triggers fade-out animation before navigation
- Prevents rapid clicks
- Respects `target="_blank"` and `data-no-transition` attributes

**Implementation:**
```javascript
// Click handler on document intercepts navigation
// Applies fadeOut animation to <main>
// Delays navigation by 400ms for animation completion
```

**Excluded Links:**
- External links (different origin)
- Links with `target="_blank"`
- Links with `data-no-transition` attribute

---

#### 6. Scroll Animation System

**Purpose:** Trigger animations when elements enter viewport.

**API:**
```javascript
// Initialize scroll-triggered animations
animateOnScroll()
```

**Features:**
- Uses Intersection Observer API
- Triggers `slideUp` animation on scroll
- Sets initial opacity to 0 for animation effect
- Observes: `section`, `.content-card`, `.grid > div`

**Configuration:**
```javascript
const observerOptions = {
  threshold: 0.1,
  rootMargin: '0px 0px -50px 0px'
};
```

**How to Use:**
- Mark elements with natural selectors or classes
- System automatically detects and animates on scroll
- Animation applies once and element stops being observed

---

### Storage & Persistence

#### Storage Functions

**`setStorage(key, value)`**
- Stores data in localStorage
- Falls back to cookies if localStorage unavailable
- Error handling for quota exceeded

**`getStorage(key)`**
- Retrieves data from localStorage
- Falls back to cookies if needed
- Returns `null` if not found

**`setCookie(name, value, days = 365)`**
- Sets cookie with expiration
- Default expiration: 1 year
- Path set to root

**`getCookie(name)`**
- Retrieves cookie value by name
- Returns `null` if not found
- Handles multiple cookies

**Usage Example:**
```javascript
// Store user preference
setStorage('theme', 'dark');

// Retrieve user preference
const theme = getStorage('theme') || 'dark';

// Use for disclaimer
setStorage('disclaimerAccepted', 'true');
```

---

## HTML Components

### Header Component

**Generated By:** `getHeaderHTML(currentPage)`

**Features:**
- Sticky positioning
- Backdrop blur effect
- Responsive navigation
- GitHub source button
- Logo links to home
- Slide-down animation

**Structure:**
```html
<header class="bg-black/80 backdrop-blur-md sticky top-0">
  <div class="container mx-auto">
    <!-- Logo with link to home -->
    <a href="index.html" class="flex items-center gap-2">
      <span class="material-symbols-outlined">terminal</span>
      <h1>Nasty<span class="neon-text">Nomenclature</span></h1>
    </a>
    
    <!-- Navigation -->
    <nav><!-- Active state managed by buildNavLinks() --></nav>
    
    <!-- GitHub Button -->
    <button onclick="openSourceModal()"><!-- GitHub SVG --></button>
  </div>
</header>
```

**Insertion Point:** `<div id="site-header"></div>`

---

### Footer Component

**Generated By:** `getFooterHTML()`

**Features:**
- Centered content
- Copyright information
- Privacy policy link
- Slide-up animation

**Structure:**
```html
<footer class="bg-black py-8 text-center border-t">
  <p class="text-gray-500 text-sm">
    &copy; 2026 Bit Gravy. Remember: Always sanitize your inputs.
    <a href="privacy.html">Privacy Policy</a>
    <span>No developers were harmed...</span>
  </p>
</footer>
```

**Insertion Point:** `<div id="site-footer"></div>`

---

### Modal Components

#### Source Code Modal

**ID:** `sourceModal`

**Features:**
- GitHub icon SVG
- Confirmation message
- Two-button interface
- Keyboard support (ESC)
- Animate scale-in entry

**Trigger:** GitHub button click → `openSourceModal()`

**Buttons:**
- "Stay Here" → `closeSourceModal()`
- "Continue" → `confirmSourceRedirect()`

---

#### Disclaimer Modal

**ID:** `disclaimerModal`

**Features:**
- Warning icon
- Content warning text
- Adult content list
- Two-button interface (Accept/Reject)

**Trigger:** Page load (if not previously accepted)

**Buttons:**
- "Don't Enter" → `rejectDisclaimer()`
- "Enter" → `acceptDisclaimer()`

---

## External Libraries

### CDN-Hosted Dependencies

| Library | Version | Purpose | URL |
|---|---|---|---|
| **Tailwind CSS** | Latest | Utility CSS framework | `https://cdn.tailwindcss.com` |
| **Google Fonts** | Latest | Typography (Cinzel, Lato) | `https://fonts.googleapis.com/css2?...` |
| **Material Symbols** | Latest | Icons | `https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:...` |

### No Build Process

The site requires **no build process** or package manager:

- No Node.js/npm required
- No bundling
- Direct browser loading of HTML files
- All dependencies loaded via CDN

### Library Specifics

#### Tailwind CSS

**Config Location:** Inline in each HTML file

**Customizations:**
```javascript
{
  colors: { brand: { dark, purple, accent, accentDark } },
  fontFamily: { brand: ['Cinzel'], body: ['Lato'] },
  animation: { /* 13+ custom animations */ },
  keyframes: { /* animation definitions */ }
}
```

**Usage:** Utility classes in HTML (e.g., `bg-black`, `text-fuchsia-500`)

#### Google Fonts

**Loaded Fonts:**
- Cinzel (weight 700) - Display/headings
- Lato (weights 400, 700) - Body text

**Optimization:** `display=swap` for FOUT (Flash of Unstyled Text) prevention

#### Material Symbols

**Icon Set:** Material Symbols Outlined

**Configuration:** `opsz=24, wght=400, FILL=1, GRAD=0`

**Usage:**
```html
<span class="material-symbols-outlined">icon_name</span>
```

**Common Icons:**
- `terminal` - Logo
- `warning` - Alerts
- `keyboard_double_arrow_down` - Navigation
- `fiber_manual_record` - Bullet points
- `content_copy` - Copy button

---

## Utility Functions

### Disclaimer System

```javascript
function acceptDisclaimer()      // Mark as accepted
function rejectDisclaimer()      // Reject and redirect
```

**Use Case:** Content warning flow on first visit

---

### Modal Control

```javascript
function openSourceModal()             // Show modal
function closeSourceModal()            // Hide modal
function handleSourceModalKeydown()    // Keyboard handler
function confirmSourceRedirect()       // Navigate to GitHub
```

**Use Case:** GitHub link gating and user confirmation

---

### Layout Generation

```javascript
function getHeaderHTML(currentPage)    // Generate header HTML
function getFooterHTML()               // Generate footer HTML
function getSourceModalHTML()          // Generate modal HTML
```

**Use Case:** Dynamic layout injection on page load

---

### Navigation

```javascript
function buildNavLinks(currentPage)    // Generate nav with active state
function inferCurrentPage()            // Detect current page
```

**Use Case:** Navigation menu with active state indicators

---

### Page Transitions

```javascript
function setupPageTransitions()        // Intercept navigation links
function animateOnScroll()             // Trigger animations on scroll
```

**Use Case:** Smooth page transitions and content reveals

---

## Component Patterns

### Pattern 1: Shared Layout Injection

**Use Case:** DRY (Don't Repeat Yourself) - Single header/footer

**Implementation:**
1. Each HTML has placeholder `<div id="site-header"></div>`
2. On DOMContentLoaded, `renderSharedLayout()` injects components
3. Components read `data-page` to apply active states
4. Reduces code duplication across 5 pages

**Files Affected:** All HTML pages

**Benefits:**
- Centralized header/footer updates
- Consistent navigation across site
- Easier maintenance

---

### Pattern 2: Modal Stack

**Use Case:** Multiple modals (disclaimer, source, future)

**Implementation:**
1. Disclaimer injected directly in HTML
2. Source modal injected by JavaScript
3. Both use common open/close functions
4. Backdrop click closes modals (can be added)

**Benefits:**
- Extensible for future modals
- Consistent interaction patterns
- Centralized modal logic

---

### Pattern 3: Event Delegation

**Use Case:** Handle navigation clicks

**Implementation:**
```javascript
document.addEventListener('click', function(e) {
  const link = e.target.closest('a');
  if (link && link.href.endsWith('.html')) {
    // Handle page transition
  }
});
```

**Benefits:**
- Single event listener (not per-link)
- Handles dynamically added links
- Efficient memory usage

---

### Pattern 4: Storage with Fallback

**Use Case:** Persist user preferences (disclaimer acceptance)

**Implementation:**
1. Try localStorage first (fast, large quota)
2. Fall back to cookies (universal, smaller quota)
3. Error handling for quota exceeded

**Benefits:**
- Works in all browsers
- Handles private/incognito mode
- Graceful degradation

---

### Pattern 5: Data Attributes for Configuration

**Use Case:** Page-specific settings without JavaScript

**Implementation:**
```html
<body data-page="styles">
  <!-- Page-specific content -->
</body>
```

**Benefits:**
- Easy to read in HTML
- Accessible to JavaScript
- No hard-coding URLs

---

## Usage Examples

### Adding a New Reusable Component

1. **Define the function** in `js/common.js`:
   ```javascript
   function getMyComponentHTML() {
     return `<div><!-- markup --></div>`;
   }
   ```

2. **Inject on page load** in `renderSharedLayout()`:
   ```javascript
   const element = document.getElementById('my-component-slot');
   if (element) {
     element.innerHTML = getMyComponentHTML();
   }
   ```

3. **Add placeholder** in HTML:
   ```html
   <div id="my-component-slot"></div>
   ```

4. **Add API functions** for interaction:
   ```javascript
   function openMyComponent() { /* ... */ }
   function closeMyComponent() { /* ... */ }
   ```

---

### Creating a New Page Using Components

1. **Copy an existing page** (e.g., `styles.html`)
2. **Update page metadata:**
   ```html
   <title>New Page Title</title>
   <meta name="description" content="...">
   <body data-page="unique-key">
   ```
3. **Keep layout placeholders:**
   ```html
   <div id="site-header"></div>
   <main><!-- Your content --></main>
   <div id="site-footer"></div>
   ```
4. **Include common script:**
   ```html
   <script src="js/common.js"></script>
   ```
5. **Add to NAV_ITEMS** if needed in `js/common.js`

---

## Library Update Checklist

When updating external libraries:

- [ ] Verify CDN URL is correct
- [ ] Test in all target browsers
- [ ] Check for breaking changes in API
- [ ] Update Tailwind config if needed
- [ ] Test responsive design
- [ ] Verify animations still work
- [ ] Test accessibility features
- [ ] Commit changes with clear message

---

## Performance Notes

- **JavaScript Size:** Single `common.js` file (~8KB)
- **CSS Delivery:** Tailwind CDN (~30KB gzipped)
- **Font Loading:** Optimized with `display=swap`
- **Icons:** Lightweight font-based (Material Symbols)
- **Images:** Lazy loaded with `data-src` attributes

---

## Browser Support

- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- Mobile browsers (iOS Safari, Chrome Android)

All components tested for:
- CSS Grid/Flexbox support
- CSS Variables support
- IntersectionObserver API
- Modern JavaScript (ES6+)

---

**Last Updated:** January 2026  
**Maintained By:** Development Team  
**Status:** Active
